{% extends "base.html" %}

{% block title %}Ad Hoc Chat - Code Reviser UI{% endblock %}

{% block content %}

<div class="container mt-5">
    <div class="card">
        <div class="card-body" id="chat-container">
            <!-- Chat messages will be displayed here -->
            {% for message in result.split('\n') %}
            <div>{{ message }}</div>
            {% endfor %}
        </div>
        <div class="card-footer">
            <form id="chat-form" method="POST" action="{{ url_for('ad_hoc_chat') }}">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Enter your prompt" name="prompt" required>
                    <button type="submit" class="btn btn-primary">Send</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Set an interval to refresh the page every 5 seconds
        var refreshInterval = setInterval(function() {
            location.reload();
        }, 5000);

        // Stop refreshing when the input has focus
        var promptInput = document.querySelector('input[name="prompt"]');
        promptInput.addEventListener('focus', function() {
            clearInterval(refreshInterval);
        });

        // Resume refreshing when the input loses focus
        promptInput.addEventListener('blur', function() {
            refreshInterval = setInterval(function() {
                location.reload();
            }, 500);
        });
    });
</script>

{% endblock %}