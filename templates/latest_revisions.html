{% extends "base.html" %}

{% block title %}Executive Review - Code Reviser UI{% endblock %}

{% block content %}
<div class="container mt-4">
   <h2>Executive Review</h2>
   <div id="revisionsAccordion">
       {% for revision in revisions %}
       <div class="accordion mb-3" id="revisionsAccordion_{{ revision.filename }}_{{ revision.revision_id }}">
           <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ revision.filename }}_{{ revision.revision_id }}" aria-expanded="false" aria-controls="collapse{{ revision.filename }}_{{ revision.revision_id }}">
               <h2 class="accordion-header">{{ revision.filename }}</h2>
           </button>
           <div id="collapse{{ revision.filename }}_{{ revision.revision_id }}" class="accordion-collapse collapse" data-bs-parent="#revisionsAccordion_{{ revision.filename }}_{{ revision.revision_id }}">
               <div class="accordion-body">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#editRevision{{ loop.index }}" aria-expanded="false" aria-controls="editRevision{{ loop.index }}">
                            Edit Revision
                        </button>
                    </h2>
                    <div id="editRevision{{ loop.index }}" class="accordion-collapse collapse" data-bs-parent=".accordion">
                        <div class="container mt-2">
                            <h2>Edit Revision</h2>
                            <form method="post" action="{{ url_for('edit_revision', filename=revision.filename, revision_id=revision.revision_id) }}">
                                <div class="mb-3">
                                   <label for="new_content" class="form-label">New Content</label>
                                   <textarea class="form-control" id="new_content" name="new_content" rows="20" required>{{ revision_content }}</textarea>
                                </div>
                                <div class="mb-3">
                                   <label for="new_instruction" class="form-label">New Instructions</label>
                                   <textarea class="form-control" id="new_instruction" name="new_instruction" rows="5" required>{{ initial_instruction }}</textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">Save Changes</button>
                            </form>
                        </div>
                    </div>
                 </div>
               </div>
           </div>
       </div>
       {% endfor %}
   </div>
</div>
{% endblock %}